{"version":3,"sources":["../../../../assets/scripts/assets/scripts/Unique.js"],"names":["cc","Class","ctor","recordMap","setBuildFunc","buildFunc","_buildFunc","setResetFunc","resetFunc","_resetFunc","reset","key","record","obj","add","type","count","args","sub"],"mappings":";;;;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,QADK,kBACC;AACF,aAAKC,SAAL,GAAiB,EAAjB;AACH,KAHI;AAILC,gBAJK,wBAIQC,SAJR,EAIkB;AACnB,aAAKC,UAAL,GAAkBD,SAAlB;AACH,KANI;AAOLE,gBAPK,wBAOQC,SAPR,EAOkB;AACnB,aAAKC,UAAL,GAAkBD,SAAlB;AACH,KATI;AAULE,SAVK,mBAUE;AACH,aAAI,IAAIC,GAAR,IAAe,KAAKR,SAApB,EAA8B;AAC1B,gBAAIS,SAAS,KAAKT,SAAL,CAAeQ,GAAf,CAAb;AACA,gBAAGC,UAAQ,KAAKH,UAAhB,EAA2B;AACvB,qBAAKA,UAAL,CAAgBG,OAAOC,GAAvB;AACH;AACJ;AACD,aAAKV,SAAL,GAAiB,EAAjB;AACH,KAlBI;AAmBLW,OAnBK,eAmBDC,IAnBC,EAmBY;AACb,YAAIH,SAAS,KAAKT,SAAL,CAAeY,IAAf,CAAb;AACA,YAAGH,MAAH,EAAU;AACNA,mBAAOI,KAAP;AACA,mBAAOJ,OAAOC,GAAd;AACH;;AALY,0CAALI,IAAK;AAALA,gBAAK;AAAA;;AAMb,YAAIJ,MAAM,KAAKP,UAAL,cAAgBS,IAAhB,4BAAwBE,IAAxB,GAAV;AACA,aAAKd,SAAL,CAAeY,IAAf,IAAqB,EAACF,KAAIA,GAAL,EAASG,OAAM,CAAf,EAArB;AACA,eAAOH,GAAP;AACH,KA5BI;AA6BLK,OA7BK,eA6BDH,IA7BC,EA6BY;AACb,YAAIH,SAAS,KAAKT,SAAL,CAAeY,IAAf,CAAb;AACA,YAAG,CAACH,MAAJ,EAAW;AACP;AACH;AACDA,eAAOI,KAAP;AACA,YAAGJ,OAAOI,KAAP,IAAc,CAAjB,EAAmB;AACf,gBAAG,KAAKP,UAAR,EAAmB;AAAA,mDAPfQ,IAOe;AAPfA,wBAOe;AAAA;;AACf,qBAAKR,UAAL,cAAgBG,OAAOC,GAAvB,4BAA8BI,IAA9B;AACH;AACD,mBAAO,KAAKd,SAAL,CAAeY,IAAf,CAAP;AACH;AACJ;AAzCI,CAAT","file":"Unique.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n    ctor(){\n        this.recordMap = {}\n    },\n    setBuildFunc(buildFunc){\n        this._buildFunc = buildFunc;\n    },\n    setResetFunc(resetFunc){\n        this._resetFunc = resetFunc;\n    },\n    reset(){\n        for(var key in this.recordMap){\n            var record = this.recordMap[key];\n            if(record&&this._resetFunc){\n                this._resetFunc(record.obj);\n            }\n        }\n        this.recordMap = {};\n    },\n    add(type,...args){\n        var record = this.recordMap[type];\n        if(record){\n            record.count++;\n            return record.obj;\n        }\n        var obj = this._buildFunc(type,...args);\n        this.recordMap[type]={obj:obj,count:1};\n        return obj;\n    },\n    sub(type,...args){\n        var record = this.recordMap[type];\n        if(!record){\n            return;\n        }\n        record.count--;\n        if(record.count<=0){\n            if(this._resetFunc){\n                this._resetFunc(record.obj,...args);\n            }\n            delete this.recordMap[type];\n        }\n    }\n});"]}