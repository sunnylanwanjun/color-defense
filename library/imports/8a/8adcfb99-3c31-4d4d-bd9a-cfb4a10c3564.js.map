{"version":3,"sources":["../../../../../assets/scripts/node/assets/scripts/node/SkinMgr.js"],"names":["cc","Class","ctor","skinLayerMap","undefined","initSkinMgr","layerMap","unInitSkinMgr","getSkin","skinInfo","atlas","skinNode","type","AniFrameNode","require","updateAtlas","updateInfo","ParticalNode","showSkin","posOrNode","layerName","layer","error","pos","Node","worldPos","convertToWorldSpaceAR","Vec2","ZERO","convertToNodeSpaceAR","skin","x","y","addChild"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,QADK,kBACC;AACF,aAAKC,YAAL,GAAoBC,SAApB;AACH,KAHI;AAILC,eAJK,uBAIOC,QAJP,EAIgB;AACjB,aAAKH,YAAL,GAAoBG,QAApB;AACH,KANI;AAOLC,iBAPK,2BAOU;AACX,aAAKJ,YAAL,GAAoBC,SAApB;AACH,KATI;AAULI,WAVK,mBAUGC,QAVH,EAUYC,KAVZ,EAUkB;AACnB,YAAIC,WAAWP,SAAf;AACA,YAAGK,SAASG,IAAT,IAAiB,OAApB,EAA4B;AACxB,gBAAIC,eAAeC,QAAQ,cAAR,CAAnB;AACAH,uBAAW,IAAIE,YAAJ,EAAX;AACA,gBAAGH,KAAH,EAAS;AACLC,yBAASI,WAAT,CAAqBL,KAArB;AACH;AACDC,qBAASK,UAAT,CAAoBP,QAApB;AACH,SAPD,MAOM,IAAGA,SAASG,IAAT,IAAiB,UAApB,EAA+B;AACjC,gBAAIK,eAAeH,QAAQ,cAAR,CAAnB;AACAH,uBAAW,IAAIM,YAAJ,EAAX;AACA,gBAAGP,KAAH,EAAS;AACLC,yBAASI,WAAT,CAAqBL,KAArB;AACH;AACDC,qBAASK,UAAT,CAAoBP,QAApB;AACH;AACD,eAAOE,QAAP;AACH,KA5BI;AA6BLO,YA7BK,oBA6BIC,SA7BJ,EA6BcV,QA7Bd,EA6BuBC,KA7BvB,EA6B6BU,SA7B7B,EA6BuC;AACxCA,oBAAYA,aAAa,QAAzB;AACA,YAAIC,QAAQ,KAAKlB,YAAL,CAAkBiB,SAAlB,CAAZ;AACA,YAAG,CAACC,KAAJ,EAAU;AACNrB,eAAGsB,KAAH,CAAS,2CAAT,EAAqDF,SAArD;AACA;AACH;;AAED,YAAIG,MAAMJ,SAAV;AACA,YAAGA,qBAAqBnB,GAAGwB,IAA3B,EAAgC;AAC5B,gBAAIC,WAAWN,UAAUO,qBAAV,CAAgC1B,GAAG2B,IAAH,CAAQC,IAAxC,CAAf;AACAL,kBAAMF,MAAMQ,oBAAN,CAA2BJ,QAA3B,CAAN;AACH;;AAED,YAAIK,OAAO,KAAKtB,OAAL,CAAaC,QAAb,EAAsBC,KAAtB,CAAX;AACAoB,aAAKC,CAAL,GAASR,IAAIQ,CAAb;AACAD,aAAKE,CAAL,GAAST,IAAIS,CAAb;AACAX,cAAMY,QAAN,CAAeH,IAAf;AACH;AA/CI,CAAT","file":"SkinMgr.js","sourceRoot":"../../../../../assets/scripts/node","sourcesContent":["cc.Class({\n    ctor(){\n        this.skinLayerMap = undefined;\n    },\n    initSkinMgr(layerMap){\n        this.skinLayerMap = layerMap;\n    },\n    unInitSkinMgr(){\n        this.skinLayerMap = undefined;\n    },\n    getSkin(skinInfo,atlas){\n        var skinNode = undefined;\n        if(skinInfo.type == \"frame\"){\n            var AniFrameNode = require(\"AniFrameNode\");\n            skinNode = new AniFrameNode();\n            if(atlas){\n                skinNode.updateAtlas(atlas);\n            }\n            skinNode.updateInfo(skinInfo);\n        }else if(skinInfo.type == \"partical\"){\n            var ParticalNode = require(\"ParticalNode\");\n            skinNode = new ParticalNode();\n            if(atlas){\n                skinNode.updateAtlas(atlas);\n            }\n            skinNode.updateInfo(skinInfo);\n        }\n        return skinNode;\n    },\n    showSkin(posOrNode,skinInfo,atlas,layerName){\n        layerName = layerName || \"effect\";\n        var layer = this.skinLayerMap[layerName];\n        if(!layer){\n            cc.error(\"SkinMgr:showSkin layer is empty,layerName\",layerName);\n            return;\n        }\n\n        var pos = posOrNode;\n        if(posOrNode instanceof cc.Node){\n            var worldPos = posOrNode.convertToWorldSpaceAR(cc.Vec2.ZERO);\n            pos = layer.convertToNodeSpaceAR(worldPos);\n        }\n\n        var skin = this.getSkin(skinInfo,atlas);\n        skin.x = pos.x;\n        skin.y = pos.y;\n        layer.addChild(skin);\n    },\n});"]}