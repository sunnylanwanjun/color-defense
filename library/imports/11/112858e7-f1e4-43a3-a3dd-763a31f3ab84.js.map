{"version":3,"sources":["../../../../../assets/scripts/component/assets/scripts/component/Move.js"],"names":["cc","Class","extends","Component","properties","xNode","default","undefined","type","Node","yNode","centerNode","onDestroy","onLoad","on","event","xNodeDown","stopPropagation","bind","yNodeDown","centerNodeDown","node","getButton","Event","EventMouse","BUTTON_LEFT","xNodeHandle","yNodeHandle","centerNodeHandle","setMoveHandle","moveHandle","delta","getDelta","parent","x","Math","floor","y"],"mappings":"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","file":"Move.js","sourceRoot":"../../../../../assets/scripts/component","sourcesContent":["cc.Class({\n    extends:cc.Component,\n    properties:{\n        xNode:{\n            default:undefined,\n            type:cc.Node,\n        },\n        yNode:{\n            default:undefined,\n            type:cc.Node,\n        },\n        centerNode:{\n            default:undefined,\n            type:cc.Node,\n        },\n    },\n    onDestroy(){\n\n    },\n    onLoad(){\n        //关于事件系统的几点思考\n        //事件有捕获capture，at_active，bubbling阶段\n        /*\n            A\n            B\n            C\n        A为B的父节点，B为C的父节点，当C被点击时，捕获阶段发生的顺序为\n        A->B->C,at_active阶段为C，冒泡阶段为C->B->A，如果event调用\n        stopPropagation 则整个事件触发机制会中断，如果只是调用_propagationImmediateStopped，则只是不会调用C本身的冒泡回调，\n        父节点捕获回调，父点节冒泡回调都不会受到影响，和API文档中描述的不一至\n        */\n        this.xNode.on('touchstart',function(event){\n            this.xNodeDown = true;\n            event.stopPropagation();\n        }.bind(this));\n        this.yNode.on('touchstart',function(event){\n            this.yNodeDown = true;\n            event.stopPropagation();\n        }.bind(this));\n        this.centerNode.on('touchstart',function(event){\n            this.centerNodeDown = true;\n            event.stopPropagation();\n        }.bind(this));\n\n        this.node.on('mousemove',function(event){\n            if(event.getButton() != cc.Event.EventMouse.BUTTON_LEFT){\n                this.xNodeDown = false;\n                this.yNodeDown = false;\n                this.centerNodeDown = false;\n                return;\n            }\n\n            if(this.xNodeDown){\n                this.xNodeHandle(event);\n                return;\n            }\n            if(this.yNodeDown){\n                this.yNodeHandle(event);\n                return;\n            }\n            if(this.centerNodeDown){\n                this.centerNodeHandle(event);\n                return;\n            }\n        }.bind(this),this,true);\n    },\n    setMoveHandle(moveHandle){\n        this.moveHandle = moveHandle;\n    },\n    xNodeHandle(event){\n        var delta = event.getDelta();\n        this.node.parent.x += delta.x;\n        this.node.parent.x = Math.floor(this.node.parent.x);\n        if(this.moveHandle){\n            this.moveHandle();\n        }\n    },\n    yNodeHandle(event){\n        var delta = event.getDelta();\n        this.node.parent.y += delta.y;\n        this.node.parent.y = Math.floor(this.node.parent.y);\n        if(this.moveHandle){\n            this.moveHandle();\n        }\n    },\n    centerNodeHandle(event){\n        var delta = event.getDelta();\n        this.node.parent.x += delta.x;\n        this.node.parent.y += delta.y;\n        this.node.parent.x = Math.floor(this.node.parent.x);\n        this.node.parent.y = Math.floor(this.node.parent.y);\n        if(this.moveHandle){\n            this.moveHandle();\n        }\n    },\n});"]}