{"version":3,"sources":["../../../../../assets/scripts/component/assets/scripts/component/Game.js"],"names":["cc","Class","extends","Component","properties","btnEditor","default","undefined","type","Node","passLabel","Label","createTowerNode","opearteTowerNode","layerNode","goldLabel","onLoad","manager","director","getCollisionManager","enabled","enabledDebugDraw","gameConfig","enabledDebugDraw_game","enabledDrawBoundingBox","enabledDrawBoundingBox_game","active","isEditorMode","globalEvent","on","initGameData","changeGold","LayerMgr","require","layerMgr","initLayerMgr","curPassData","passData","getCurPassData","string","passIdx","onDestroy","off","unInitLayerMgr","update","dt","logicUpdate","gameData","gold","toEditor","editData","editRow","utils","loadScene","toSelect"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAU;AACNC,qBAAQC,SADF;AAENC,kBAAKR,GAAGS;AAFF,SADF;AAKRC,mBAAU;AACNJ,qBAAQC,SADF;AAENC,kBAAKR,GAAGW;AAFF,SALF;AASRC,yBAAgB;AACZN,qBAAQC,SADI;AAEZC,kBAAKR,GAAGS;AAFI,SATR;AAaRI,0BAAiB;AACbP,qBAAQC,SADK;AAEbC,kBAAKR,GAAGS;AAFK,SAbT;AAiBRK,mBAAU;AACNR,qBAAQC,SADF;AAENC,kBAAKR,GAAGS;AAFF,SAjBF;AAqBRM,mBAAU;AACNT,qBAAQC,SADF;AAENC,kBAAKR,GAAGW;AAFF;AArBF,KAHP;AA6BLK,UA7BK,oBA6BK;AACN,YAAIC,UAAUjB,GAAGkB,QAAH,CAAYC,mBAAZ,EAAd;AACAF,gBAAQG,OAAR,GAAkB,IAAlB;AACAH,gBAAQI,gBAAR,GAA2BrB,GAAGsB,UAAH,CAAcC,qBAAzC;AACAN,gBAAQO,sBAAR,GAAiCxB,GAAGsB,UAAH,CAAcG,2BAA/C;;AAEA,aAAKpB,SAAL,CAAeqB,MAAf,GAAwB1B,GAAGsB,UAAH,CAAcK,YAAtC;;AAEA3B,WAAG4B,WAAH,CAAeC,EAAf,CAAkB,sBAAlB,EAAyC,KAAKC,YAA9C,EAA2D,IAA3D;AACA9B,WAAG4B,WAAH,CAAeC,EAAf,CAAkB,oBAAlB,EAAuC,KAAKE,UAA5C,EAAuD,IAAvD;AACA,aAAKD,YAAL;;AAEA,YAAIE,WAAWC,QAAQ,cAAR,CAAf;AACA,aAAKC,QAAL,GAAgB,IAAIF,QAAJ,EAAhB;AACA,aAAKE,QAAL,CAAcC,YAAd,CAA2B,KAAKrB,SAAhC;AACH,KA5CI;AA6CLgB,gBA7CK,0BA6CS;AACV,aAAKM,WAAL,GAAmBpC,GAAGqC,QAAH,CAAYC,cAAZ,EAAnB;AACA,aAAK5B,SAAL,CAAe6B,MAAf,GAAwB,UAAQ,KAAKH,WAAL,CAAiBI,OAAjD;AACA,aAAKT,UAAL;AACH,KAjDI;AAkDLU,aAlDK,uBAkDM;AACPzC,WAAG4B,WAAH,CAAec,GAAf,CAAmB,sBAAnB,EAA0C,KAAKZ,YAA/C,EAA4D,IAA5D;AACA9B,WAAG4B,WAAH,CAAec,GAAf,CAAmB,oBAAnB,EAAwC,KAAKX,UAA7C,EAAwD,IAAxD;;AAEA,YAAId,UAAUjB,GAAGkB,QAAH,CAAYC,mBAAZ,EAAd;AACAF,gBAAQG,OAAR,GAAkB,IAAlB;AACAH,gBAAQI,gBAAR,GAA2B,KAA3B;AACAJ,gBAAQO,sBAAR,GAAiC,KAAjC;;AAEA,aAAKU,QAAL,CAAcS,cAAd;AACH,KA5DI;AA8DLC,UA9DK,kBA8DEC,EA9DF,EA8DK;AACN,aAAKX,QAAL,CAAcY,WAAd,CAA0BD,EAA1B;AACH,KAhEI;AAkELd,cAlEK,wBAkEO;AACR,aAAKhB,SAAL,CAAewB,MAAf,GAAwB,UAAQ,KAAKH,WAAL,CAAiBW,QAAjB,CAA0BC,IAA1D;AACH,KApEI;AAsELC,YAtEK,sBAsEK;AACNjD,WAAGkD,QAAH,CAAYC,OAAZ,CAAoB,MAApB,EAA2B,KAAKf,WAAL,CAAiBI,OAA5C;AACAxC,WAAGoD,KAAH,CAASC,SAAT,CAAmB,QAAnB;AACH,KAzEI;AA2ELC,YA3EK,sBA2EK;AACNtD,WAAGoD,KAAH,CAASC,SAAT,CAAmB,QAAnB;AACH;AA7EI,CAAT","file":"Game.js","sourceRoot":"../../../../../assets/scripts/component","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        btnEditor:{\n            default:undefined,\n            type:cc.Node,\n        },\n        passLabel:{\n            default:undefined,\n            type:cc.Label,\n        },\n        createTowerNode:{\n            default:undefined,\n            type:cc.Node,\n        },\n        opearteTowerNode:{\n            default:undefined,\n            type:cc.Node,\n        },\n        layerNode:{\n            default:undefined,\n            type:cc.Node,\n        },\n        goldLabel:{\n            default:undefined,\n            type:cc.Label,\n        }\n    },\n    onLoad () {\n        var manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n        manager.enabledDebugDraw = cc.gameConfig.enabledDebugDraw_game;\n        manager.enabledDrawBoundingBox = cc.gameConfig.enabledDrawBoundingBox_game;\n\n        this.btnEditor.active = cc.gameConfig.isEditorMode;\n\n        cc.globalEvent.on(\"CurData:initGameData\",this.initGameData,this);\n        cc.globalEvent.on(\"CurData:changeGold\",this.changeGold,this);\n        this.initGameData();\n\n        var LayerMgr = require(\"GameLayerMgr\");\n        this.layerMgr = new LayerMgr();\n        this.layerMgr.initLayerMgr(this.layerNode);\n    },\n    initGameData(){\n        this.curPassData = cc.passData.getCurPassData();\n        this.passLabel.string = \"pass:\"+this.curPassData.passIdx;\n        this.changeGold();\n    },\n    onDestroy(){\n        cc.globalEvent.off(\"CurData:initGameData\",this.initGameData,this);\n        cc.globalEvent.off(\"CurData:changeGold\",this.changeGold,this);\n\n        var manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n        manager.enabledDebugDraw = false;\n        manager.enabledDrawBoundingBox = false;\n        \n        this.layerMgr.unInitLayerMgr();\n    },\n\n    update(dt){\n        this.layerMgr.logicUpdate(dt);\n    },\n\n    changeGold(){\n        this.goldLabel.string = \"gold:\"+this.curPassData.gameData.gold;\n    },\n\n    toEditor(){\n        cc.editData.editRow(\"pass\",this.curPassData.passIdx);\n        cc.utils.loadScene(\"editor\");\n    },\n\n    toSelect(){\n        cc.utils.loadScene(\"select\");\n    },\n});\n"]}