{"version":3,"sources":["../../../../../assets/scripts/data/assets/scripts/data/UserData.js"],"names":["cc","Class","ctor","playerID","userName","curPassIdx","curMaxPassIdx","headIcon","init","callback","window","hasOwnProperty","log","sdkVersion","FBInstant","getSDKVersion","player","getID","getName","getPhoto","getDataAsync","then","data","parseInt","bind","gameConfig","isTestMode","saveMaxPass","passIdx","setDataAsync","console","setStatsAsync","savePass"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,QADK,kBACC;AACF,aAAKC,QAAL,GAAgB,CAAhB;AACA,aAAKC,QAAL,GAAgB,OAAhB;AACA,aAAKC,UAAL,GAAkB,CAAlB;AACA,aAAKC,aAAL,GAAqB,CAArB;AACA,aAAKC,QAAL,GAAgB,EAAhB;AACH,KAPI;AAQLC,QARK,gBAQAC,QARA,EAQS;AACV,YAAGC,UAAQA,OAAOC,cAAP,CAAsB,WAAtB,CAAX,EAA8C;AAC1CX,eAAGY,GAAH,CAAO,2BAAP;;AAEA,gBAAIC,aAAaC,UAAUC,aAAV,EAAjB;AACAf,eAAGY,GAAH,CAAO,4CAAP,EAAoDC,UAApD;;AAEA,iBAAKV,QAAL,GAAgBW,UAAUE,MAAV,CAAiBC,KAAjB,EAAhB;AACA,iBAAKb,QAAL,GAAgBU,UAAUE,MAAV,CAAiBE,OAAjB,EAAhB;AACA,iBAAKX,QAAL,GAAgBO,UAAUE,MAAV,CAAiBG,QAAjB,EAAhB;;AAEA;AACAL,sBAAUE,MAAV,CACCI,YADD,CACc,CAAC,YAAD,EAAe,eAAf,CADd,EAECC,IAFD,CAEM,UAASC,IAAT,EAAe;AACjB,qBAAKjB,UAAL,GAAkBkB,SAASD,KAAK,YAAL,KAAoB,CAA7B,CAAlB;AACA,qBAAKhB,aAAL,GAAqBiB,SAASD,KAAK,eAAL,KAAuB,CAAhC,CAArB;AACAtB,mBAAGY,GAAH,CAAO,8BAAP;AACAH;AACH,aALK,CAKJe,IALI,CAKC,IALD,CAFN;;AASA;AACH;;AAEDxB,WAAGyB,UAAH,CAAcC,UAAd,GAA2B,IAA3B;AACAjB;AACH,KAlCI;AAmCLkB,eAnCK,uBAmCOC,OAnCP,EAmCe;AAChB,YAAGA,WAAS,KAAKtB,aAAjB,EAA+B;AAC3B;AACH;;AAED,aAAKA,aAAL,GAAqBsB,OAArB;AACA,YAAGlB,UAAQA,OAAOC,cAAP,CAAsB,WAAtB,CAAX,EAA8C;AAC1C;AACAG,sBAAUE,MAAV,CACCa,YADD,CACc;AACVvB,+BAAe,KAAKA;AADV,aADd,EAICe,IAJD,CAIM,YAAW;AACbS,wBAAQlB,GAAR,CAAY,mCAAZ,EAAgD,KAAKN,aAArD;AACH,aAFK,CAEJkB,IAFI,CAEC,IAFD,CAJN;;AAQA;AACAV,sBAAUE,MAAV,CACCe,aADD,CACe;AACXzB,+BAAe,KAAKA;AADT,aADf,EAICe,IAJD,CAIM,YAAW;AACbS,wBAAQlB,GAAR,CAAY,oCAAZ,EAAiD,KAAKN,aAAtD;AACH,aAFK,CAEJkB,IAFI,CAEC,IAFD,CAJN;AAOA;AACH;AACJ,KA7DI;AA8DLQ,YA9DK,oBA8DIJ,OA9DJ,EA8DY;AACb,aAAKvB,UAAL,GAAkBuB,OAAlB;AACA,YAAGlB,UAAQA,OAAOC,cAAP,CAAsB,WAAtB,CAAX,EAA8C;AAC1C;AACAG,sBAAUE,MAAV,CACCa,YADD,CACc;AACVxB,4BAAY,KAAKA;AADP,aADd,EAICgB,IAJD,CAIM,YAAW;AACbS,wBAAQlB,GAAR,CAAY,gCAAZ,EAA6C,KAAKP,UAAlD;AACH,aAFK,CAEJmB,IAFI,CAEC,IAFD,CAJN;;AAQA;AACAV,sBAAUE,MAAV,CACCe,aADD,CACe;AACX1B,4BAAY,KAAKA;AADN,aADf,EAICgB,IAJD,CAIM,YAAW;AACbS,wBAAQlB,GAAR,CAAY,iCAAZ,EAA8C,KAAKP,UAAnD;AACH,aAFK,CAEJmB,IAFI,CAEC,IAFD,CAJN;;AAQA;AACH;AACJ;AArFI,CAAT","file":"UserData.js","sourceRoot":"../../../../../assets/scripts/data","sourcesContent":["cc.Class({\n    ctor(){\n        this.playerID = 0;\n        this.userName = \"guest\";\n        this.curPassIdx = 0;\n        this.curMaxPassIdx = 0;\n        this.headIcon = \"\";\n    },\n    init(callback){\n        if(window&&window.hasOwnProperty(\"FBInstant\")){\n            cc.log(\"begin init fbinstant data\");\n\n            var sdkVersion = FBInstant.getSDKVersion();\n            cc.log(\"!!!!!!!!!!!!!!!!!!!!!!FBInstant sdkVersion\",sdkVersion);\n\n            this.playerID = FBInstant.player.getID();\n            this.userName = FBInstant.player.getName();\n            this.headIcon = FBInstant.player.getPhoto();\n\n            //获取玩家数据\n            FBInstant.player\n            .getDataAsync(['curPassIdx', 'curMaxPassIdx'])\n            .then(function(data) {\n                this.curPassIdx = parseInt(data['curPassIdx']||0);\n                this.curMaxPassIdx = parseInt(data['curMaxPassIdx']||0);\n                cc.log(\"finished init fbinstant data\");\n                callback();\n            }.bind(this));\n\n            return;\n        }\n\n        cc.gameConfig.isTestMode = true;\n        callback();\n    },\n    saveMaxPass(passIdx){\n        if(passIdx<=this.curMaxPassIdx){\n            return;\n        }\n\n        this.curMaxPassIdx = passIdx;\n        if(window&&window.hasOwnProperty(\"FBInstant\")){\n            //存储玩家数据\n            FBInstant.player\n            .setDataAsync({\n                curMaxPassIdx: this.curMaxPassIdx,\n            })\n            .then(function() {\n                console.log('UserData:saveMaxPass setDataAsync',this.curMaxPassIdx);\n            }.bind(this));\n\n            //设置玩家统计数据\n            FBInstant.player\n            .setStatsAsync({\n                curMaxPassIdx: this.curMaxPassIdx,\n            })\n            .then(function() {\n                console.log('UserData:saveMaxPass setStatsAsync',this.curMaxPassIdx);\n            }.bind(this));\n            return;\n        }\n    },\n    savePass(passIdx){\n        this.curPassIdx = passIdx;\n        if(window&&window.hasOwnProperty(\"FBInstant\")){\n            //存储玩家数据\n            FBInstant.player\n            .setDataAsync({\n                curPassIdx: this.curPassIdx,\n            })\n            .then(function() {\n                console.log('UserData:savePass setDataAsync',this.curPassIdx);\n            }.bind(this));\n\n            //设置玩家统计数据\n            FBInstant.player\n            .setStatsAsync({\n                curPassIdx: this.curPassIdx,\n            })\n            .then(function() {\n                console.log('UserData:savePass setStatsAsync',this.curPassIdx);\n            }.bind(this));\n\n            return;\n        }\n    },\n})"]}