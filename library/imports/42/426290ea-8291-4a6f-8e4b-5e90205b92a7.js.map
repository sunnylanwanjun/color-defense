{"version":3,"sources":["../../../../../assets/scripts/data/assets/scripts/data/ColorData.js"],"names":["CurData","require","cc","Class","extends","ctor","initGameData","_super","gameResult","undefined","gameData","campMap","targetCamp","bornMap","gold","configData","initGold","campArr","key","campData","camp","hp","targetArr","length","targetInfo","globalEvent","emit","changeCampHp","changeVal","setGameResult","result","changeGold","val"],"mappings":";;;;;;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACAC,GAAGC,KAAH,CAAS;AACLC,aAAQJ,OADH;AAELK,QAFK,kBAEC,CAEL,CAJI;AAMLC,gBANK,0BAMS;AACV,aAAKC,MAAL;AACA,aAAKC,UAAL,GAAkBC,SAAlB;AACA,aAAKC,QAAL,GAAgB;AACZC,qBAAU,EADE;AAEZC,wBAAaH,SAFD;AAGZI,qBAAU,EAHE;AAIZC,kBAAO,KAAKC,UAAL,CAAgBC;AAJX,SAAhB;AAMA,YAAIC,UAAU,KAAKF,UAAL,CAAgBE,OAA9B;AACA,aAAI,IAAIC,GAAR,IAAeD,OAAf,EAAuB;AACnB,gBAAIE,WAAWF,QAAQC,GAAR,CAAf;AACA,iBAAKR,QAAL,CAAcC,OAAd,CAAsBQ,SAASC,IAA/B,IAAqCD,SAASE,EAA9C;AACH;;AAED;AACA,YAAIC,YAAY,KAAKP,UAAL,CAAgBO,SAAhC;AACA,YAAGA,UAAUC,MAAV,GAAiB,CAApB,EAAsB;AAClB,iBAAKb,QAAL,CAAcE,UAAd,GAA2BU,UAAU,CAAV,EAAaF,IAAxC;AACA,iBAAI,IAAIF,GAAR,IAAeI,SAAf,EAAyB;AACrB,oBAAIE,aAAaF,UAAUJ,GAAV,CAAjB;AACA,oBAAG,KAAKR,QAAL,CAAcE,UAAd,IAA4BY,WAAWJ,IAA1C,EAA+C;AAC3C,yBAAKV,QAAL,CAAcE,UAAd,GAA2BH,SAA3B;AACH;AACJ;AACJ;;AAEDP,WAAGuB,WAAH,CAAeC,IAAf,CAAoB,sBAApB,EAA2C,KAAKlB,UAAhD;AACAN,WAAGuB,WAAH,CAAeC,IAAf,CAAoB,sBAApB;AACH,KAnCI;AAoCLC,gBApCK,wBAoCQP,IApCR,EAoCaQ,SApCb,EAoCuB;AACxB,YAAIjB,UAAU,KAAKD,QAAL,CAAcC,OAA5B;AACAA,gBAAQS,IAAR,KAAiBQ,SAAjB;AACA,YAAGjB,QAAQS,IAAR,IAAc,CAAjB,EAAmB;AACfT,oBAAQS,IAAR,IAAgB,CAAhB;AACH;AACDlB,WAAGuB,WAAH,CAAeC,IAAf,CAAoB,sBAApB,EAA2C,EAACN,MAAKA,IAAN;AACvCC,gBAAGV,QAAQS,IAAR,CADoC,EAA3C;AAEA,YAAG,KAAKV,QAAL,CAAcE,UAAd,IAA4BQ,IAA5B,IAAoCT,QAAQS,IAAR,KAAiB,CAAxD,EAA0D;AACtD,iBAAKS,aAAL,CAAmB,MAAnB;AACH;AACJ,KA/CI;AAgDLA,iBAhDK,yBAgDSC,MAhDT,EAgDgB;AACjB,YAAG,KAAKtB,UAAR,EAAmB;AACf;AACH;AACD,aAAKA,UAAL,GAAkBsB,MAAlB;AACA5B,WAAGuB,WAAH,CAAeC,IAAf,CAAoB,sBAApB,EAA2C,KAAKlB,UAAhD;AACH,KAtDI;AAuDLuB,cAvDK,sBAuDMC,GAvDN,EAuDU;AACX,aAAKtB,QAAL,CAAcI,IAAd,IAAsBkB,GAAtB;AACA9B,WAAGuB,WAAH,CAAeC,IAAf,CAAoB,oBAApB,EAAyC,KAAKhB,QAAL,CAAcI,IAAvD;AACH;AA1DI,CAAT","file":"ColorData.js","sourceRoot":"../../../../../assets/scripts/data","sourcesContent":["var CurData = require(\"CurData\");\ncc.Class({\n    extends:CurData,\n    ctor(){\n\n    },\n\n    initGameData(){\n        this._super();\n        this.gameResult = undefined;\n        this.gameData = {\n            campMap : {},\n            targetCamp : undefined,\n            bornMap : {},\n            gold : this.configData.initGold,\n        }\n        var campArr = this.configData.campArr;\n        for(var key in campArr){\n            var campData = campArr[key];\n            this.gameData.campMap[campData.camp]=campData.hp;\n        }\n\n        //如果目标阵营多于一个，则认为无法确认目标阵营，可能为多玩家情况\n        var targetArr = this.configData.targetArr;\n        if(targetArr.length>0){\n            this.gameData.targetCamp = targetArr[0].camp;\n            for(var key in targetArr){\n                var targetInfo = targetArr[key];\n                if(this.gameData.targetCamp != targetInfo.camp){\n                    this.gameData.targetCamp = undefined;    \n                }\n            }\n        }\n\n        cc.globalEvent.emit(\"CurData:updateResult\",this.gameResult);\n        cc.globalEvent.emit(\"CurData:initGameData\");\n    },\n    changeCampHp(camp,changeVal){\n        var campMap = this.gameData.campMap\n        campMap[camp] += changeVal;\n        if(campMap[camp]<0){\n            campMap[camp] = 0;\n        }\n        cc.globalEvent.emit(\"CurData:changeCampHp\",{camp:camp,\n            hp:campMap[camp]});\n        if(this.gameData.targetCamp == camp && campMap[camp] == 0){\n            this.setGameResult(\"lost\");\n        }\n    },\n    setGameResult(result){\n        if(this.gameResult){\n            return;\n        }\n        this.gameResult = result;\n        cc.globalEvent.emit(\"CurData:updateResult\",this.gameResult);\n    },\n    changeGold(val){\n        this.gameData.gold += val;\n        cc.globalEvent.emit(\"CurData:changeGold\",this.gameData.gold);\n    },\n})"]}