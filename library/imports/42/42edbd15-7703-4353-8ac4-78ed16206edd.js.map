{"version":3,"sources":["../../../../../assets/scripts/component/assets/scripts/component/ParamArea.js"],"names":["cc","Class","extends","Component","properties","jsStr","default","undefined","type","EditBox","grammarErr","Node","grammarTip","Label","changeField_Node","changeField_Name","changeField_Value","changeField_Type","ToggleContainer","onLoad","onDestroy","globalEvent","off","updateEdit","start","on","editInfo","editData","getCurEditRow","JSON","stringify","string","paramEditBegin","log","paramEditEnd","obj","parse","curEditInfo","updateRow","idx","err","console","message","active","stack","grammarErr_ICheck","setFocus","grammarErr_Rollback","paramEditReturn","clear","utils","alert","clearRow","bind","changeField","fieldName","fieldValue","trimSpace","deleteAllField","checkType","getToggleCheckLabel","transValue","parseInt","parseFloat","modifyAllField"],"mappings":"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","file":"ParamArea.js","sourceRoot":"../../../../../assets/scripts/component","sourcesContent":["cc.Class({\n    extends:cc.Component,\n    properties:{\n        jsStr:{\n            default:undefined,\n            type:cc.EditBox,\n        },\n        grammarErr:{\n            default:undefined,\n            type:cc.Node,\n        },\n        grammarTip:{\n            default:undefined,\n            type:cc.Label,\n        },\n        changeField_Node:{\n            default:undefined,\n            type:cc.Node,\n        },\n        changeField_Name:{\n            default:undefined,\n            type:cc.EditBox,\n        },\n        changeField_Value:{\n            default:undefined,\n            type:cc.EditBox,\n        },\n        changeField_Type:{\n            default:undefined,\n            type:cc.ToggleContainer,\n        },\n    },\n    onLoad(){\n        \n    },\n    onDestroy(){\n        cc.globalEvent.off(\"EditData:editRow\",this.updateEdit,this);\n        cc.globalEvent.off(\"EditData:updateList\",this.updateEdit,this);\n    },\n    start(){\n        cc.globalEvent.on(\"EditData:editRow\",this.updateEdit,this);\n        cc.globalEvent.on(\"EditData:updateList\",this.updateEdit,this);\n        this.updateEdit();\n    },\n    updateEdit(){\n        var editInfo = cc.editData.getCurEditRow();\n        var jsStr = JSON.stringify(editInfo,null,4);\n        this.jsStr.string = jsStr;\n    },\n    paramEditBegin(){\n        cc.log(\"param edit begin\");\n    },\n    paramEditEnd(){\n        cc.log(\"param edit end\");\n        try {\n            //data有可能不是合法的JSON字符串，便会产生异常\n            var obj = JSON.parse(this.jsStr.string);\n            var curEditInfo = cc.editData.curEditInfo;\n            cc.editData.updateRow(curEditInfo.type,curEditInfo.idx,obj);\n        } catch (err) {\n            console.log(\"ParamArea:paramEditEnd\",err.message);\n            this.grammarErr.active = true;\n            this.grammarTip.string = \"message:\\n\"+err.message+\"\\n\"+\"stack:\\n\"+err.stack;\n        }\n    },\n    grammarErr_ICheck(){\n        this.grammarErr.active = false;\n        this.jsStr.setFocus();\n    },\n    grammarErr_Rollback(){\n        var editInfo = cc.editData.getCurEditRow();\n        var jsStr = JSON.stringify(editInfo,null,4);\n        this.jsStr.string = jsStr;\n        this.grammarErr.active = false;\n    },\n    paramEditReturn(){\n        cc.log(\"param edit return\");\n    },\n    clear(){\n        var curEditInfo = cc.editData.curEditInfo;\n        cc.utils.alert(\"clear \"+curEditInfo.type+\" idx:\"+curEditInfo.idx,\n        function(){\n            cc.editData.clearRow(curEditInfo.type,curEditInfo.idx);    \n        }.bind(this));\n    },\n    changeField(){\n        var fieldName = this.changeField_Name.string;\n        var fieldValue = this.changeField_Value.string;\n        fieldName = fieldName.trimSpace(true);\n        fieldValue = fieldValue.trimSpace(true);\n\n        if(!fieldName){\n            console.log(\"ParamArea:changeField fieldName is empty\");\n            return;\n        }\n\n        this.changeField_Node.active = false;\n\n        if(fieldValue==\"\"){\n            console.log(\"ParamArea:changeField deleteAllField\",fieldName);\n            var curEditInfo = cc.editData.curEditInfo;\n            cc.editData.deleteAllField(curEditInfo.type,fieldName);\n            return;\n        }\n\n        var checkType = cc.utils.getToggleCheckLabel(this.changeField_Type);\n\n        var transValue = undefined;\n        switch(checkType){\n            case 'int':\n            transValue = parseInt(fieldValue);\n            break;\n            case 'str':\n            transValue = fieldValue;\n            break;\n            case 'float':\n            transValue = parseFloat(fieldValue);\n            break;\n            case 'json':\n            transValue = JSON.parse(fieldValue);\n            break;\n        }\n        var curEditInfo = cc.editData.curEditInfo;\n        cc.editData.modifyAllField(curEditInfo.type,fieldName,transValue);\n    },\n})"]}