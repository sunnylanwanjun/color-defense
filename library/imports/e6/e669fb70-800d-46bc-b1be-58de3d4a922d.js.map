{"version":3,"sources":["../../../../assets/scripts/assets/scripts/Pool.js"],"names":["cc","Class","ctor","useList","poolList","useIdx","destroy","objKey","obj","_destroyFunc","setDestroyFunc","destroyFunc","setBuildFunc","buildFunc","_buildFunc","setResetFunc","resetFunc","_resetFunc","get","pop","useFlag","pushNoUseFlag","args","push","error","reset"],"mappings":"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","file":"Pool.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n    ctor(){\n        this.useList = {};\n        this.poolList = [];\n        this.useIdx = 1;\n    },\n    destroy(){\n        for(var objKey in this.useList){\n            var obj = this.useList[objKey];\n            if(obj&&this._destroyFunc){\n                this._destroyFunc(obj);\n            }\n        }\n        for(var objKey in this.poolList){\n            var obj = this.poolList[objKey];\n            if(obj&&this._destroyFunc){\n                this._destroyFunc(obj);\n            }\n        }\n        this.useList = {};\n        this.poolList = [];\n        this.useIdx = 1;\n    },\n    setDestroyFunc(destroyFunc){\n        this._destroyFunc = destroyFunc;\n    },\n    setBuildFunc(buildFunc){\n        this._buildFunc = buildFunc;\n    },\n    setResetFunc(resetFunc){\n        this._resetFunc = resetFunc;\n    },\n    get(...args){\n        var obj = this.poolList.pop();\n        if(!obj&&this._buildFunc){\n            obj = this._buildFunc(...args);\n        }\n        if(obj){\n            obj.useFlag = this.useIdx;\n            this.useIdx = this.useIdx + 1;\n            this.useList[obj.useFlag] = obj;\n        }\n        return obj;\n    },\n    pushNoUseFlag(obj,...args){\n        if(this._resetFunc){\n            this._resetFunc(obj,...args);\n        }\n        this.poolList.push(obj);\n    },\n    push(obj,...args){\n        var useFlag = obj.useFlag;\n        if(!useFlag){\n            cc.error(\"Pool:push same obj\");\n            return;\n        }\n        delete this.useList[useFlag];\n        delete obj.useFlag;\n        if(this._resetFunc){\n            this._resetFunc(obj,...args);\n        }\n        this.poolList.push(obj);\n    },\n    reset(...args){\n        for(var objKey in this.useList){\n            var obj = this.useList[objKey];\n            if(obj){\n                if(this._resetFunc){\n                    this._resetFunc(obj,...args);\n                }\n                this.poolList.push(obj);\n            }\n        }\n        this.useList = {};\n    }\n})"]}